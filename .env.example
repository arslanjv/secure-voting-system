# Flask Configuration
FLASK_APP=run.py
FLASK_ENV=production
SECRET_KEY=your-secret-key-change-this-in-production-min-32-chars
SESSION_COOKIE_SECURE=True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Strict

# Database Configuration
# For development, use SQLite (no setup required):
DATABASE_URL=sqlite:///voting.db

# For production, use PostgreSQL:
#DATABASE_URL=postgresql://voting_user:secure_password@localhost:5432/secure_voting_db

# Alternative MySQL Configuration:
#DATABASE_URL=mysql+pymysql://voting_user:secure_password@localhost:3306/secure_voting_db

# =============================================================================
# ENCRYPTION KEYS (NEW - REQUIRED FOR SECURITY)
# =============================================================================
# Master key for encrypting sensitive data at rest (TOTP secrets, private keys)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# MUST be a valid Fernet key (44-character base64 URL-safe string ending with '=')
MASTER_ENCRYPTION_KEY=your-fernet-key-here-generate-with-command-above

# Legacy vote encryption key (for backward compatibility only)
# New votes use hybrid RSA-AES encryption with per-election keys
VOTE_ENCRYPTION_KEY=generate-a-secure-32-byte-key-base64-encoded

# Audit log HMAC signing key
AUDIT_LOG_SIGNING_KEY=generate-another-secure-key-for-hmac-signing

# =============================================================================
# SIGNING KEYS (DEPRECATED - NOW STORED IN DATABASE)
# =============================================================================
# Legacy file paths - new installations store signing keys encrypted in database
# These are only used for migration from older versions
#DIGITAL_SIGNATURE_PRIVATE_KEY_PATH=./keys/signing_private.pem
#DIGITAL_SIGNATURE_PUBLIC_KEY_PATH=./keys/signing_public.pem

# Rate Limiting
REDIS_URL=redis://localhost:6379/0
RATELIMIT_STORAGE_URL=redis://localhost:6379/0

# Email Configuration (Required for automatic invite emails)
# Gmail Example:
MAIL_SERVER=smtp.gmail.com
MAIL_PORT=587
MAIL_USE_TLS=True
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password-here

# For Gmail App Password:
# 1. Enable 2FA on your Google account
# 2. Go to https://myaccount.google.com/apppasswords
# 3. Generate an app password for "Mail"
# 4. Use that 16-character password here (not your regular password)

# Other Email Providers:
# Outlook: smtp-mail.outlook.com, port 587
# Yahoo: smtp.mail.yahoo.com, port 587
# SendGrid: smtp.sendgrid.net, port 587
# Mailgun: smtp.mailgun.org, port 587

# Application Settings
MAX_LOGIN_ATTEMPTS=5
SESSION_LIFETIME_MINUTES=60
PASSWORD_MIN_LENGTH=12

# Security Headers
FORCE_HTTPS=True
STRICT_TRANSPORT_SECURITY=True
HSTS_MAX_AGE=31536000

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=INFO
LOG_FILE=logs/app.log
AUDIT_LOG_FILE=logs/audit.log

# Remote Syslog Configuration (VULN-008 fix)
# Enable remote syslog backup for audit logs
SYSLOG_ENABLED=False
SYSLOG_HOST=your-syslog-server.example.com
SYSLOG_PORT=514
SYSLOG_FACILITY=local0

# Timezone Configuration
# Set your local timezone offset from UTC (in hours)
# Examples: 0 for UTC, 5 for PKT/IST, -5 for EST, 8 for CST/SGT
TIMEZONE_OFFSET=5

# =============================================================================
# BACKUP CODES CONFIGURATION
# =============================================================================
# Number of backup codes to generate for 2FA recovery
BACKUP_CODE_COUNT=10
